import requests
from bs4 import BeautifulSoup
from reportlab.lib.pagesizes import letter
from reportlab.platypus import SimpleDocTemplate, Paragraph, Spacer, Table, TableStyle, Image
from reportlab.lib.styles import getSampleStyleSheet
from reportlab.lib import colors

def ExportPdf(input_cve):
    url = f"https://nvd.nist.gov/vuln/detail/CVE-{input_cve}"

    response = requests.get(url)

    if response.status_code == 200:
        soup = BeautifulSoup(response.text, 'html.parser')

        pdf_filename = f"CVE-{input_cve}_info.pdf"
        doc = SimpleDocTemplate(pdf_filename, pagesize=letter)
        styles = getSampleStyleSheet()

        pdf_content = []

        # Add the logo image to the PDF content
        logo_image = "logo.png"  # Adjust the image path as needed
        pdf_content.append(Image(logo_image, width=200, height=100))

        header = soup.find(attrs={"data-testid": "page-header-vuln-id"})
        if header:
            header = header.text.strip()
            pdf_content.append(Paragraph(f"<font size='16'><b>{header}</b></font>", styles["Normal"]))

        # ... (rest of your existing code)

        doc.build(pdf_content)

        print(f"CVE information saved to {pdf_filename}")

    else:
        print(f"Failed to fetch data for CVE ID {input_cve}")

# Example usage
ExportPdf("2021-12345")  # Replace with your desired CVE ID
